@use "sass:map";

$prefix: "hero" !default;

$config: (
    // --- Sizing & Spacing ---
    "min-height": 85vh,
    "padding-y": 4rem,
    "padding-x": 2rem,
    "content-max-width": 800px,

    // --- Typography ---
    "title-font-size": "clamp(2.5rem, 5vw + 1rem, 4.5rem)",
    "title-font-weight": 700,
    "subtitle-font-size": "clamp(1.1rem, 2vw + 0.5rem, 1.5rem)",
    "subtitle-font-weight": 300,

    // --- Effects & Transitions ---
    "cta-radius": 50px,
    "transition": "all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)",

    "bg": #f8f9fa,
    "fg": #212529,
    "subtitle-fg": #495057,
    "accent-bg": #007bff,
    "accent-fg": #ffffff,
    "overlay-bg": rgba(0, 0, 0, 0.4),
    "dark-bg": #121212,
    "dark-fg": #f8f9fa,
    "dark-subtitle-fg": #adb5bd,
    "dark-accent-bg": #339dff,
    "dark-accent-fg": #ffffff,
    "dark-overlay-bg": rgba(0, 0, 0, 0.6),
    "neon-bg": #0d0221,
    "neon-fg": #fcfdfe,
    "neon-subtitle-fg": #a4a2a8,
    "neon-title-glow-color": #f222ff,
    "neon-accent-bg": #26f7fd,
    "neon-accent-fg": #0d0221,

    "brutalist-bg": #fdf500,
    "brutalist-content-bg": #ffffff,
    "brutalist-fg": #000000,
    "brutalist-accent-bg": #000000,
    "brutalist-accent-fg": #ffffff,
    "brutalist-border-color": #000000,

    "retro-bg": #000000,
    "retro-fg": #00ff41,
    "retro-font-family": "'Courier New', Courier, monospace",

    // --- SVG Data for Dividers ---
    "wave-svg-light":
        "data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3e%3cpath fill='#f8f9fa' d='M0,160L48,176C96,192,192,224,288,213.3C384,203,480,149,576,133.3C672,117,768,139,864,165.3C960,192,1056,224,1152,218.7C1248,213,1344,171,1392,149.3L1440,128L1440,320L0,320Z'%3e%3c/path%3e%3c/svg%3e",
    "wave-svg-dark":
        "data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3e%3cpath fill='#121212' d='M0,160L48,176C96,192,192,224,288,213.3C384,203,480,149,576,133.3C672,117,768,139,864,165.3C960,192,1056,224,1152,218.7C1248,213,1344,171,1392,149.3L1440,128L1440,320L0,320Z'%3e%3c/path%3e%3c/svg%3e"
) !default;

.#{$prefix} {
    // --- Generate CSS custom properties from the $config map ---
    @each $key, $value in $config {
        --#{$prefix}-#{$key}: #{$value};
    }

    // --- Set contextual variables for theming ---
    --#{$prefix}-current-bg: var(--#{$prefix}-bg);
    --#{$prefix}-current-fg: var(--#{$prefix}-fg);
    --#{$prefix}-current-subtitle-fg: var(--#{$prefix}-subtitle-fg);
    --#{$prefix}-current-accent-bg: var(--#{$prefix}-accent-bg);
    --#{$prefix}-current-accent-fg: var(--#{$prefix}-accent-fg);
    --#{$prefix}-current-overlay-bg: var(--#{$prefix}-overlay-bg);

    // --- Core Layout & Appearance ---
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: var(--#{$prefix}-min-height);
    padding: var(--#{$prefix}-padding-y) var(--#{$prefix}-padding-x);
    background-color: var(--#{$prefix}-current-bg);
    color: var(--#{$prefix}-current-fg);
    text-align: center;
    overflow: hidden;

    // --- BEM Elements ---
    &__background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
        background-size: cover;
        background-position: center;

        // Overlay for images and videos
        &::before {
            content: "";
            position: absolute;
            inset: 0;
            background-color: var(--#{$prefix}-current-overlay-bg);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 2;
        }

        video {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            transform: translate(-50%, -50%);
            z-index: 1;
        }
    }

    &__content {
        position: relative;
        z-index: 2;
        max-width: var(--#{$prefix}-content-max-width);
    }

    &__title {
        font-size: var(--#{$prefix}-title-font-size);
        font-weight: var(--#{$prefix}-title-font-weight);
        margin: 0 0 0.5em 0;
        line-height: 1.2;
    }

    &__subtitle {
        font-size: var(--#{$prefix}-subtitle-font-size);
        font-weight: var(--#{$prefix}-subtitle-font-weight);
        color: var(--#{$prefix}-current-subtitle-fg);
        margin: 0 auto 1.5em;
        max-width: 600px;
    }

    &__cta-group {
        display: flex;
        gap: 1rem;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
    }

    &__cta {
        display: inline-block;
        background-color: var(--#{$prefix}-current-accent-bg);
        color: var(--#{$prefix}-current-accent-fg);
        padding: 0.8rem 2.2rem;
        border-radius: var(--#{$prefix}-cta-radius);
        text-decoration: none;
        font-weight: 600;
        transition: var(--#{$prefix}-transition);
        transform: scale(1);
        border: 1px solid transparent;

        &:hover {
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            filter: brightness(1.1);
        }
    }
}

.#{$prefix} {
    // --- Split Layout ---
    &.is-split {
        padding: 0;
        .#{$prefix}__background {
            display: none;
        } // Hide the main background
        .#{$prefix}__container {
            display: flex;
            flex-direction: row;
            max-width: none;
            width: 100%;
        }
        .#{$prefix}__media-pane,
        .#{$prefix}__content-pane {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--#{$prefix}-padding-y) var(--#{$prefix}-padding-x);
            min-height: var(--#{$prefix}-min-height);
        }
        .#{$prefix}__media-pane {
            background-size: cover;
            background-position: center;
        }
        .#{$prefix}__content {
            text-align: left;
        }
        // Responsive stacking
        @media (max-width: 768px) {
            .#{$prefix}__container {
                flex-direction: column;
            }
            .#{$prefix}__content {
                text-align: center;
            }
            &.has-media-on-left {
                .#{$prefix}__container {
                    flex-direction: column-reverse;
                }
            }
        }
    }
    &.has-media-on-left {
        .#{$prefix}__container {
            flex-direction: row-reverse;
        }
    }

    // --- Offset Content ---
    &.is-offset-left {
        justify-content: flex-start;
        text-align: left;
        .#{$prefix}__content {
            margin-left: 10%;
        }
        .#{$prefix}__cta-group {
            justify-content: flex-start;
        }
        @media (max-width: 768px) {
            justify-content: center;
            text-align: center;
            .#{$prefix}__content {
                margin-left: 0;
            }
            .#{$prefix}__cta-group {
                justify-content: center;
            }
        }
    }
}

.#{$prefix} {
    &.has-image,
    &.has-video {
        .#{$prefix}__background::before {
            opacity: 1;
        }
    }
    &.has-gradient {
        .#{$prefix}__background {
            background: linear-gradient(
                45deg,
                #ff6b6b,
                #4ecdc4,
                #45b7d1,
                #feca57
            );
            background-size: 400% 400%;
            animation: hero-gradient-flow 15s ease infinite;
        }
    }
    &.has-pattern-geometric {
        .#{$prefix}__background {
            background-color: #2a3a4a;
            background-image:
                linear-gradient(45deg, #3c4f62 25%, transparent 25%),
                linear-gradient(-45deg, #3c4f62 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #3c4f62 75%),
                linear-gradient(-45deg, transparent 75%, #3c4f62 75%);
            background-size: 20px 20px;
        }
    }
    &.is-parallax {
        .#{$prefix}__background {
            background-attachment: fixed;
        }
    }
}

.#{$prefix} {
    // --- Dividers ---
    &.has-angled-divider::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 25vh;
        background: var(--#{$prefix}-current-bg);
        clip-path: polygon(0 100%, 100% 0, 100% 100%);
        z-index: 3;
    }
    &.has-wavy-divider {
        padding-bottom: 150px; // Make space for the wave
        &::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background-image: var(--#{$prefix}-wave-svg-light);
            background-repeat: no-repeat;
            background-size: cover;
            z-index: 3;
        }
    }

    // --- Content Styles ---
    &.is-glassmorphism {
        .#{$prefix}__content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px) saturate(150%);
            padding: 2.5rem;
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    }

    // --- Text Effects ---
    &.has-glitch-text .#{$prefix}__title {
        position: relative;
        animation: hero-glitch-skew 1s infinite linear alternate-reverse;
        &::before,
        &::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        &::before {
            left: 2px;
            text-shadow: -2px 0 #ff00c1;
            clip: rect(44px, 450px, 56px, 0);
            animation: hero-glitch-anim 5s infinite linear alternate-reverse;
        }
        &::after {
            left: -2px;
            text-shadow:
                -2px 0 #00fff9,
                2px 2px #ff00c1;
            animation: hero-glitch-anim-2 1s infinite linear alternate-reverse;
        }
    }
}

.#{$prefix} {
    &.is-neon {
        --#{$prefix}-current-bg: var(--#{$prefix}-neon-bg);
        --#{$prefix}-current-fg: var(--#{$prefix}-neon-fg);
        --#{$prefix}-current-subtitle-fg: var(--#{$prefix}-neon-subtitle-fg);
        --#{$prefix}-current-accent-bg: var(--#{$prefix}-neon-accent-bg);
        --#{$prefix}-current-accent-fg: var(--#{$prefix}-neon-accent-fg);
        .#{$prefix}__title {
            color: var(--#{$prefix}-neon-title-glow-color);
            text-shadow:
                0 0 5px var(--#{$prefix}-neon-title-glow-color),
                0 0 10px var(--#{$prefix}-neon-title-glow-color),
                0 0 20px var(--#{$prefix}-neon-title-glow-color);
        }
        .#{$prefix}__cta:hover {
            box-shadow:
                0 0 15px var(--#{$prefix}-neon-accent-bg),
                0 0 25px var(--#{$prefix}-neon-accent-bg);
        }
    }
    &.is-brutalist {
        background-color: transparent; // The main wrapper is transparent
        .#{$prefix}__background {
            background-color: var(--#{$prefix}-brutalist-bg);
        }
        .#{$prefix}__content {
            background: var(--#{$prefix}-brutalist-content-bg);
            color: var(--#{$prefix}-brutalist-fg);
            padding: 2rem;
            border: 3px solid var(--#{$prefix}-brutalist-border-color);
            box-shadow: 10px 10px 0 var(--#{$prefix}-brutalist-border-color);
        }
        --#{$prefix}-current-subtitle-fg: var(--#{$prefix}-brutalist-fg);
        --#{$prefix}-current-accent-bg: var(--#{$prefix}-brutalist-accent-bg);
        --#{$prefix}-current-accent-fg: var(--#{$prefix}-brutalist-accent-fg);
        .#{$prefix}__cta {
            border-radius: 0;
            border: 2px solid var(--#{$prefix}-brutalist-border-color);
        }
        .#{$prefix}__cta:hover {
            background-color: var(--#{$prefix}-brutalist-content-bg) !important;
            color: var(--#{$prefix}-brutalist-accent-bg) !important;
        }
    }
    &.is-retro-terminal {
        --#{$prefix}-current-bg: var(--#{$prefix}-retro-bg);
        --#{$prefix}-current-fg: var(--#{$prefix}-retro-fg);
        --#{$prefix}-current-subtitle-fg: var(--#{$prefix}-retro-fg);
        --#{$prefix}-current-accent-bg: var(--#{$prefix}-retro-fg);
        --#{$prefix}-current-accent-fg: var(--#{$prefix}-retro-bg);
        font-family: var(--#{$prefix}-retro-font-family);
        .#{$prefix}__subtitle::after {
            content: "_";
            animation: hero-blink 1s step-end infinite;
        }
    }
}

.dark .#{$prefix},
.#{$prefix}.is-dark {
    // Allow forcing dark mode with a class
    --#{$prefix}-current-bg: var(--#{$prefix}-dark-bg);
    --#{$prefix}-current-fg: var(--#{$prefix}-dark-fg);
    --#{$prefix}-current-subtitle-fg: var(--#{$prefix}-dark-subtitle-fg);
    --#{$prefix}-current-accent-bg: var(--#{$prefix}-dark-accent-bg);
    --#{$prefix}-current-accent-fg: var(--#{$prefix}-dark-accent-fg);
    --#{$prefix}-current-overlay-bg: var(--#{$prefix}-dark-overlay-bg);

    &.has-wavy-divider::after {
        background-image: var(--#{$prefix}-wave-svg-dark);
    }
    &.has-angled-divider::after {
        background: var(--#{$prefix}-dark-bg);
    }
}

@keyframes hero-gradient-flow {
    0% {
        background-position: 0 50%;
    }
    50% {
        background-position: 100% 50%;
    }
    100% {
        background-position: 0 50%;
    }
}
@keyframes hero-glitch-skew {
    0% {
        transform: skewX(0deg);
    }
    10% {
        transform: skewX(3deg);
    }
    40% {
        transform: skewX(-2deg);
    }
    70% {
        transform: skewX(1deg);
    }
    100% {
        transform: skewX(0deg);
    }
}
@keyframes hero-glitch-anim {
    0% {
        clip: rect(42px, 9999px, 44px, 0);
    }
    10% {
        clip: rect(20px, 9999px, 80px, 0);
    }
    100% {
        clip: rect(1px, 9999px, 90px, 0);
    }
}
@keyframes hero-glitch-anim-2 {
    0% {
        clip: rect(85px, 9999px, 90px, 0);
    }
    30% {
        clip: rect(10px, 9999px, 50px, 0);
    }
    100% {
        clip: rect(2px, 9999px, 70px, 0);
    }
}
@keyframes hero-blink {
    50% {
        opacity: 0;
    }
}
