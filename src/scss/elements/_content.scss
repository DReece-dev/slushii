@use "sass:map";

$prefix: "content" !default;

$config: (
    // --- Base Typography & Color ---
    "base-font-size": 1rem,
    "fg": #4a4a4a,
    "heading-fg": #363636,
    "heading-font-weight": 600,
    "heading-line-height": 1.125,
    "link-fg": #3273dc,
    "link-hover-fg": #363636,

    // --- Sizing & Spacing ---
    "base-margin-block": 1em,
    "h1-font-size": 2em,
    "h2-font-size": 1.75em,
    "h3-font-size": 1.5em,
    "h4-font-size": 1.25em,
    "h5-font-size": 1.125em,
    "h6-font-size": 1em,

    // --- Blockquote ---
    "blockquote-bg": #f5f5f5,
    "blockquote-border-color": #dbdbdb,
    "blockquote-border-width": 5px,
    "blockquote-padding-y": 1.25em,
    "blockquote-padding-x": 1.5em,

    // --- Lists ---
    "list-margin-left": 2em,
    "list-item-spacing": 0.25em,

    // --- Table ---
    "table-border-color": #dbdbdb,
    "table-cell-padding-y": 0.5em,
    "table-cell-padding-x": 0.75em,
    "table-head-fg": #363636,
    "table-head-border-width": 2px,

    "dark-fg": #d1d5db,
    "dark-heading-fg": #f3f4f6,
    "dark-link-fg": #60a5fa,
    "dark-link-hover-fg": #d1d5db,
    "dark-blockquote-bg": #374151,
    "dark-blockquote-border-color": #4b5563,
    "dark-table-border-color": #4b5563,
    "dark-table-head-fg": #f3f4f6
) !default;

.#{$prefix} {
    // --- Generate CSS custom properties from the $config map ---
    @each $key, $value in $config {
        --#{$prefix}-#{$key}: #{$value};
    }

    font-size: var(--#{$prefix}-base-font-size);
    color: var(--#{$prefix}-fg);

    // --- Block Element Spacing ---
    p,
    dl,
    ol,
    ul,
    blockquote,
    pre,
    table {
        &:not(:last-child) {
            margin-bottom: var(--#{$prefix}-base-margin-block);
        }
    }

    // --- Headings ---
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        color: var(--#{$prefix}-heading-fg);
        font-weight: var(--#{$prefix}-heading-font-weight);
        line-height: var(--#{$prefix}-heading-line-height);

        &:not(:first-child) {
            margin-top: 1.5em; // Give headings a bit more space
        }
    }

    h1 {
        font-size: var(--#{$prefix}-h1-font-size);
        margin-bottom: 0.5em;
    }
    h2 {
        font-size: var(--#{$prefix}-h2-font-size);
        margin-bottom: 0.5714em;
    }
    h3 {
        font-size: var(--#{$prefix}-h3-font-size);
        margin-bottom: 0.6666em;
    }
    h4 {
        font-size: var(--#{$prefix}-h4-font-size);
        margin-bottom: 0.8em;
    }
    h5 {
        font-size: var(--#{$prefix}-h5-font-size);
        margin-bottom: 0.8888em;
    }
    h6 {
        font-size: var(--#{$prefix}-h6-font-size);
        margin-bottom: 1em;
    }

    // --- Other Elements ---
    blockquote {
        background-color: var(--#{$prefix}-blockquote-bg);
        border-left: var(--#{$prefix}-blockquote-border-width) solid
            var(--#{$prefix}-blockquote-border-color);
        padding: var(--#{$prefix}-blockquote-padding-y)
            var(--#{$prefix}-blockquote-padding-x);
    }

    ol,
    ul {
        margin-left: var(--#{$prefix}-list-margin-left);
        margin-top: var(--#{$prefix}-base-margin-block);

        li + li {
            margin-top: var(--#{$prefix}-list-item-spacing);
        }
    }

    ol {
        list-style-position: outside;
        &:not([type]) {
            list-style-type: decimal;
        }
        &.is-lower-alpha {
            list-style-type: lower-alpha;
        }
        &.is-lower-roman {
            list-style-type: lower-roman;
        }
        &.is-upper-alpha {
            list-style-type: upper-alpha;
        }
        &.is-upper-roman {
            list-style-type: upper-roman;
        }
    }

    ul {
        list-style: disc outside;
        ul {
            list-style-type: circle;
            margin-top: calc(var(--#{$prefix}-list-item-spacing) * 2);
            ul {
                list-style-type: square;
            }
        }
    }

    dd {
        margin-left: var(--#{$prefix}-list-margin-left);
    }

    figure {
        margin: 0; // Reset default figure margins
        &:not(:first-child) {
            margin-top: 2em;
        }
        &:not(:last-child) {
            margin-bottom: 2em;
        }
    }

    pre {
        overflow-x: auto;
        white-space: pre;
        word-wrap: normal;
        background-color: var(
            --#{$prefix}-blockquote-bg
        ); // Re-use for consistency
        padding: var(--#{$prefix}-blockquote-padding-y)
            var(--#{$prefix}-blockquote-padding-x);
        border-radius: 6px;
    }

    sup,
    sub {
        font-size: 75%;
    }

    table {
        width: 100%;

        td,
        th {
            border-bottom: 1px solid var(--#{$prefix}-table-border-color);
            padding: var(--#{$prefix}-table-cell-padding-y)
                var(--#{$prefix}-table-cell-padding-x);
            vertical-align: top;
        }

        th {
            color: var(--#{$prefix}-table-head-fg);
            text-align: inherit;
        }

        thead td,
        thead th {
            border-bottom-width: var(--#{$prefix}-table-head-border-width);
        }

        tfoot td,
        tfoot th {
            border-top: var(--#{$prefix}-table-head-border-width) solid
                var(--#{$prefix}-table-border-color);
            border-bottom-width: 0;
        }

        tbody tr:last-child td,
        tbody tr:last-child th {
            border-bottom-width: 0;
        }
    }
}

.#{$prefix}.is-small {
    --#{$prefix}-base-font-size: 0.875rem;
}
.#{$prefix}.is-medium {
    --#{$prefix}-base-font-size: 1.25rem;
}
.#{$prefix}.is-large {
    --#{$prefix}-base-font-size: 1.5rem;
}

.dark .#{$prefix} {
    --#{$prefix}-fg: var(--#{$prefix}-dark-fg);
    --#{$prefix}-heading-fg: var(--#{$prefix}-dark-heading-fg);
    --#{$prefix}-link-fg: var(--#{$prefix}-dark-link-fg);
    --#{$prefix}-link-hover-fg: var(--#{$prefix}-dark-link-hover-fg);
    --#{$prefix}-blockquote-bg: var(--#{$prefix}-dark-blockquote-bg);
    --#{$prefix}-blockquote-border-color: var(
        --#{$prefix}-dark-blockquote-border-color
    );
    --#{$prefix}-table-border-color: var(--#{$prefix}-dark-table-border-color);
    --#{$prefix}-table-head-fg: var(--#{$prefix}-dark-table-head-fg);
}
