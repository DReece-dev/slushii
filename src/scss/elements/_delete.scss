@use "sass:map";

$prefix: "delete" !default;

$config: (
    // --- Sizing ---
    "size": 1.25rem,
    // 20px
    "sm-size": 1rem,
    // 16px
    "md-size": 1.5rem,
    // 24px
    "lg-size": 2rem,

    // 32px
    // --- Appearance ---
    "cross-thickness": 2px,
    "radius": 9999px,

    // --- Animation ---
    "transition":
        "background-color 0.15s ease, opacity 0.15s ease, transform 0.15s ease",

    "bg": rgba(10, 10, 10, 0.2),
    "fg": white,
    "hover-bg": rgba(10, 10, 10, 0.3),
    "active-bg": rgba(10, 10, 10, 0.4),
    "focus-ring-color": rgba(10, 10, 10, 0.4),
    "dark-bg": rgba(255, 255, 255, 0.2),
    "dark-fg": #1f2937,
    // gray-800
    "dark-hover-bg": rgba(255, 255, 255, 0.3),
    "dark-active-bg": rgba(255, 255, 255, 0.4),
    "dark-focus-ring-color": rgba(255, 255, 255, 0.4)
) !default;

// Use a more semantic selector for a button
button.#{$prefix} {
    // --- Generate CSS custom properties from the $config map ---
    @each $key, $value in $config {
        --#{$prefix}-#{$key}: #{$value};
    }

    // Set a contextual size variable that can be overridden by modifiers
    --#{$prefix}-current-size: var(--#{$prefix}-size);

    // --- Reset & Base Styles ---
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    border: none;
    cursor: pointer;
    display: inline-block;
    flex-grow: 0;
    flex-shrink: 0;
    font-size: 0; // Hides any text/font rendering issues
    outline: none;
    padding: 0;
    position: relative;
    vertical-align: top;
    user-select: none;

    // --- Core Appearance (uses variables) ---
    background-color: var(--#{$prefix}-bg);
    border-radius: var(--#{$prefix}-radius);
    transition: var(--#{$prefix}-transition);

    // --- Sizing (uses contextual variable) ---
    width: var(--#{$prefix}-current-size);
    height: var(--#{$prefix}-current-size);

    // --- The "X" cross mark ---
    &::before,
    &::after {
        background-color: var(--#{$prefix}-fg);
        content: "";
        display: block;
        left: 50%;
        position: absolute;
        top: 50%;
        transform-origin: center;
        height: var(--#{$prefix}-cross-thickness);
        width: 50%; // Make the cross proportional to the button size
    }

    &::before {
        transform: translate(-50%, -50%) rotate(45deg);
    }

    &::after {
        transform: translate(-50%, -50%) rotate(-45deg);
    }

    // --- States ---
    &:hover,
    &:focus {
        background-color: var(--#{$prefix}-hover-bg);
    }

    &:focus-visible {
        outline: 2px solid var(--#{$prefix}-focus-ring-color);
        outline-offset: 2px;
    }

    &:active {
        background-color: var(--#{$prefix}-active-bg);
        transform: scale(0.95);
    }

    // Disabled state
    &[disabled] {
        opacity: 0.5;
        pointer-events: none;
    }
}

// =============================================================================
// 3. SIZE MODIFIERS
// =============================================================================

button.#{$prefix} {
    &.is-small {
        --#{$prefix}-current-size: var(--#{$prefix}-sm-size);
    }
    &.is-medium {
        --#{$prefix}-current-size: var(--#{$prefix}-md-size);
    }
    &.is-large {
        --#{$prefix}-current-size: var(--#{$prefix}-lg-size);
    }
}

// =============================================================================
// 4. DARK MODE THEME
// =============================================================================
.dark button.#{$prefix} {
    --#{$prefix}-bg: var(--#{$prefix}-dark-bg);
    --#{$prefix}-fg: var(--#{$prefix}-dark-fg);
    --#{$prefix}-hover-bg: var(--#{$prefix}-dark-hover-bg);
    --#{$prefix}-active-bg: var(--#{$prefix}-dark-active-bg);
    --#{$prefix}-focus-ring-color: var(--#{$prefix}-dark-focus-ring-color);
}
