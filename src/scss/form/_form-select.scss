@use "sass:map";

$prefix: "form-select" !default;

// --- Configuration Map ---
$config: (
    // Box Model
    "padding-y": 0.5rem,
    "padding-x": 0.75rem,
    "border-width": 1px,
    "border-radius": 0.375rem,

    // Typography
    "font-size": 1rem,
    "font-weight": 400,
    "line-height": 1.5,

    // Colors (Light Theme)
    "bg": #ffffff,
    "fg": #111827,
    "border-color": #d1d5db,
    "icon-color": "#6b7280",

    // States (Light Theme)
    "focus-border-color": #3b82f6,
    "focus-ring-color": rgba(59, 130, 246, 0.25),
    "focus-ring-width": 3px,
    "disabled-bg": #f3f4f6,
    "disabled-fg": #6b7280,
    "disabled-border-color": #d1d5db,
    "disabled-opacity": 1,

    // Dark Theme
    "dark-bg": #1f2937,
    "dark-fg": #d1d5db,
    "dark-border-color": #4b5563,
    "dark-icon-color": #9ca3af,
    "dark-disabled-bg": #374151,
    "dark-disabled-fg": #9ca3af,

    // SVG Icon
    "icon-svg":
        "url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e\")",
    "icon-size": "16px 16px",
    "icon-padding": "2.25rem",

    // Transitions
    "transition": "border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out"
) !default;

// --- Base Component ---
.#{$prefix} {
    @each $key, $value in $config {
        --#{$prefix}-#{$key}: #{$value};
    }

    display: block;
    width: 100%;
    padding: var(--#{$prefix}-padding-y) var(--#{$prefix}-icon-padding)
        var(--#{$prefix}-padding-y) var(--#{$prefix}-padding-x);
    font-size: var(--#{$prefix}-font-size);
    font-weight: var(--#{$prefix}-font-weight);
    line-height: var(--#{$prefix}-line-height);
    color: var(--#{$prefix}-fg);
    background-color: var(--#{$prefix}-bg);
    background-image: var(--#{$prefix}-icon-svg);
    background-repeat: no-repeat;
    background-position: right var(--#{$prefix}-padding-x) center;
    background-size: var(--#{$prefix}-icon-size);
    border: var(--#{$prefix}-border-width) solid var(--#{$prefix}-border-color);
    border-radius: var(--#{$prefix}-border-radius);
    transition: var(--#{$prefix}-transition);
    appearance: none;

    &:focus-visible {
        border-color: var(--#{$prefix}-focus-border-color);
        outline: 0;
        box-shadow: 0 0 0 var(--#{$prefix}-focus-ring-width)
            var(--#{$prefix}-focus-ring-color);
    }

    &[multiple],
    &[size]:not([size="1"]) {
        padding-right: var(--#{$prefix}-padding-x);
        background-image: none;
    }

    &:disabled {
        color: var(--#{$prefix}-disabled-fg);
        background-color: var(--#{$prefix}-disabled-bg);
        border-color: var(--#{$prefix}-disabled-border-color);
        opacity: var(--#{$prefix}-disabled-opacity);
        cursor: not-allowed;
    }
}

// =============================================================================
// --- 25 NEW VARIANTS ---
// =============================================================================

// --- Sizing Variants (4) ---
.#{$prefix}--xs {
    --#{$prefix}-font-size: 0.75rem;
    --#{$prefix}-padding-y: 0.125rem;
    --#{$prefix}-padding-x: 0.375rem;
}
.#{$prefix}--sm {
    --#{$prefix}-font-size: 0.875rem;
    --#{$prefix}-padding-y: 0.25rem;
    --#{$prefix}-padding-x: 0.5rem;
}
.#{$prefix}--lg {
    --#{$prefix}-font-size: 1.125rem;
    --#{$prefix}-padding-y: 0.625rem;
    --#{$prefix}-padding-x: 1rem;
}
.#{$prefix}--xl {
    --#{$prefix}-font-size: 1.25rem;
    --#{$prefix}-padding-y: 0.75rem;
    --#{$prefix}-padding-x: 1.25rem;
}

// --- Style & Shape Variants (8) ---
.#{$prefix}--pill {
    --#{$prefix}-border-radius: 9999px;
}
.#{$prefix}--square {
    --#{$prefix}-border-radius: 0;
}
.#{$prefix}--flushed {
    border-radius: 0;
    border-left: 0;
    border-right: 0;
    border-top: 0;
}
.#{$prefix}--underline {
    border: none;
    border-bottom: var(--#{$prefix}-border-width) solid
        var(--#{$prefix}-border-color);
    border-radius: 0;
    padding-left: 0;
    &:focus-visible {
        box-shadow: none;
    }
}
.#{$prefix}--filled {
    --#{$prefix}-bg: #f3f4f6;
    --#{$prefix}-border-color: #f3f4f6;
    &:focus-visible {
        --#{$prefix}-bg: #ffffff;
    }
}
.#{$prefix}--ghost {
    background-color: transparent;
    border-color: transparent;
    &:hover:not(:disabled) {
        border-color: var(--#{$prefix}-border-color);
    }
}
.#{$prefix}--thick {
    --#{$prefix}-border-width: 2px;
}
.#{$prefix}--shadow {
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
}

// --- Color & State Variants (5) ---
.#{$prefix}--success {
    --#{$prefix}-border-color: #16a34a;
    &:focus-visible {
        --#{$prefix}-focus-border-color: #16a34a;
        --#{$prefix}-focus-ring-color: rgba(22, 163, 74, 0.2);
    }
}
.#{$prefix}--danger {
    --#{$prefix}-border-color: #dc2626;
    &:focus-visible {
        --#{$prefix}-focus-border-color: #dc2626;
        --#{$prefix}-focus-ring-color: rgba(220, 38, 38, 0.2);
    }
}
.#{$prefix}--warning {
    --#{$prefix}-border-color: #f97316;
    &:focus-visible {
        --#{$prefix}-focus-border-color: #f97316;
        --#{$prefix}-focus-ring-color: rgba(249, 115, 22, 0.2);
    }
}
.#{$prefix}--info {
    --#{$prefix}-border-color: #0ea5e9;
    &:focus-visible {
        --#{$prefix}-focus-border-color: #0ea5e9;
        --#{$prefix}-focus-ring-color: rgba(14, 165, 233, 0.2);
    }
}
.#{$prefix}--read-only[readonly] {
    background-color: #f8fafc;
    cursor: default;
}

// --- Arrow & Icon Variants (5) ---
.#{$prefix}--arrow-hidden {
    background-image: none;
    padding-right: var(--#{$prefix}-padding-x);
}
.#{$prefix}--arrow-sm {
    --#{$prefix}-icon-size: 12px 12px;
}
.#{$prefix}--arrow-lg {
    --#{$prefix}-icon-size: 20px 20px;
}
.#{$prefix}--arrow-thick {
    --#{$prefix}-icon-svg: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='2.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
}
.#{$prefix}--arrow-primary-on-focus:focus-visible {
    --#{$prefix}-icon-svg: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%233b82f6' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
}

// --- Behavior Variants (3) ---
.#{$prefix}--no-transition {
    --#{$prefix}-transition: none;
}
.#{$prefix}--hover-border:hover:not(:disabled) {
    border-color: var(--#{$prefix}-focus-border-color);
}
.#{$prefix}--focus-pop:focus-visible {
    transform: scale(1.02);
}

// --- Dark Mode ---
.dark .#{$prefix} {
    --#{$prefix}-bg: var(--#{$prefix}-dark-bg);
    --#{$prefix}-fg: var(--#{$prefix}-dark-fg);
    --#{$prefix}-border-color: var(--#{$prefix}-dark-border-color);
    --#{$prefix}-icon-color: var(--#{$prefix}-dark-icon-color);
    --#{$prefix}-disabled-bg: var(--#{$prefix}-dark-disabled-bg);
    --#{$prefix}-disabled-fg: var(--#{$prefix}-dark-disabled-fg);
    --#{$prefix}-icon-svg: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");

    &.#{$prefix}--filled {
        --#{$prefix}-bg: #374151;
        --#{$prefix}-border-color: #374151;
        &:focus-visible {
            --#{$prefix}-bg: var(--#{$prefix}-dark-bg);
        }
    }
}

// --- Reduced Motion ---
@media (prefers-reduced-motion: reduce) {
    .#{$prefix} {
        --#{$prefix}-transition: none;
    }
}
